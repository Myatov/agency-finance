-- Защита от дубликатов периодов: один период на (услуга, дата начала, дата конца).
-- Запускайте ПОСЛЕ удаления дубликатов (периоды без доходов и без счетов можно удалить в интерфейсе).
-- Если дубликаты остались — скрипт завершится с ошибкой, сначала удалите лишние периоды.

CREATE UNIQUE INDEX IF NOT EXISTS "WorkPeriod_serviceId_dateFrom_dateTo_key"
  ON "WorkPeriod" ("serviceId", "dateFrom", "dateTo");
